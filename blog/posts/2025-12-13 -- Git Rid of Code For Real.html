<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Git Rid Of Code For Real - IsaacPCodes Blog</title>
  <meta name="description" content="Git Rid Of Code For Real - Blog post by Isaac Pehrson">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="../../favicon.svg">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- CSS -->
  <link href="../../css/isaacpcodes.css" type="text/css" rel="stylesheet">
  <link href="../../css/blog.css" type="text/css" rel="stylesheet">
</head>
<body class="blog-page">
  <header>
    <div class="container">
      <nav>
        <a href="../../index.html" aria-label="IsaacPCodes Home" class="logo-link">
          <img src="../../assets/isaacpcodes-wordmark.svg" alt="IsaacPCodes" class="logo">
        </a>

        <input type="checkbox" id="menu-toggle" class="menu-toggle" aria-label="Toggle navigation menu">
        <label for="menu-toggle" class="menu-icon" aria-label="Menu">
          <span></span>
          <span></span>
          <span></span>
        </label>

        <ul class="nav-menu">
          <li><a href="../../index.html#projects" class="nav-link">Projects</a></li>
          <li><a href="../../index.html#about" class="nav-link">About</a></li>
          <li><a href="../../index.html#skills" class="nav-link">Skills</a></li>
          <li><a href="../../index.html#contact" class="nav-link">Contact</a></li>
          <li><a href="../index.html" aria-current="page">Blog</a></li>
          <li><a href="../../web-tools/index.html">Web Tools</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <section class="section blog-post-hero">
      <div class="container blog-container">
        <div class="blog-post-header">
          <a href="../index.html" class="btn btn-secondary blog-back-link">Back to Blog</a>
          <h1 class="blog-post-title">Git Rid Of Code For Real</h1>
          <div class="blog-post-meta">2025-12-13</div>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="container blog-container">
        <article class="blog-post-content">
<h2>Describe the issue</h2>
<p>I think we've all committed by accident a secret to a git repository, and then found it to be non-trivial to remove that from the entire git history.</p>
<p>In git, if you commit a secret or a key, it's there forever. You can remove it, but it will always live in your git history. So it's just covered up, it's not really gone.</p>
<p>For my example, i needed to remove all links of ebay.com from a particular repo. I wanted to just simply search for that domain, and if it matched on a line, i wanted that entire line deleted.</p>
<p>Not just simply deleted, but removed from all git history. Here's how i did that:</p>
<h2>Solution</h2>
<p>There are many ways to accomplish this, this is not the only way to do this, nor may all think it is the <em>correct</em> way to do this. But it did for me what i wanted.</p>
<h3>Step 1 - Clone a git mirror</h3>
<p>Since it's wise to keep a backup while we are performing this, I did all the work in a mirrored clone.</p>
<pre><code>git clone --mirror &lt;repository-url&gt; repo-mirror.git
cd repo-mirror.git
</code></pre>
<h3>Step 2 - Remove Files/Directories/String matches</h3>
<h4>When i wanted to remove directories completely:</h4>
<pre><code>git filter-repo --path src/components/UnwantedComponent --invert-paths
</code></pre>
<h4>When i wanted to remove by a string match:</h4>
<p>The normal syntax for this string-replace is something like</p>
<p><code>search-string==&gt;replace-string</code></p>
<p>And then the command would be:</p>
<p><code>git filter-repo --replace-text ./replacements.txt</code></p>
<p><code>replacements.txt</code> being a simple text file i created with the string match syntax.</p>
<p>I wanted to do something a little tricky, i wasn't simply finding and replacing strings. Instead I wanted to look for matches of 'ebay.com' and then remove the entire line. In order to do this i used a regex approach:</p>
<p><code>regex:.*secret.example.com.*\n==&gt;</code></p>
<p>What this does
.*secret.example.com.* → matches the entire line containing the secret</p>
<p>\n → includes the newline so the whole line disappears cleanly</p>
<p>==&gt; with nothing on the right → deletes it</p>
<h3>Step 4 - Push Changes to Remote</h3>
<p><code>git push --force</code></p>
<h3>Step 4 - Confirm removals worked</h3>
<p>Search repo and ensure string was removed:</p>
<p><code>git rev-list --all | xargs -n 1 git grep -n &quot;ebay.com&quot; || echo &quot;Not found&quot;</code></p>
<p>I did find that i had to repeat the &quot;clone/delete/push&quot; steps a couple times to entirely remove everything. But after a few clones, i can now confirm all matches of said string have been removed.</p>
<h2>Conclusion</h2>
<p>Yeah so there are likely hundreds of ways to do this, and those that have done this several times may be able to point out more proper ways of performing this. But I found these steps to work for me and it performed a difficult Git task that comes up sometimes.</p>
        </article>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="footer-content">
        <p>&copy; 2025 IsaacPCodes. Built with care.</p>
        <div class="footer-links">
          <a href="../../support.html">Support</a>
          <a href="../../privacy.html">Privacy Policy</a>
          <a href="../../web-tools/index.html">Web Tools</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const navLinks = document.querySelectorAll('.nav-link');
      const menuToggle = document.getElementById('menu-toggle');

      navLinks.forEach(link => {
        link.addEventListener('click', function() {
          if (menuToggle.checked) {
            menuToggle.checked = false;
          }
        });
      });
    });
  </script>
</body>
</html>
