<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git Rid Of Code For Real - IsaacPCodes Blog</title>
    <meta name="description" content="Git Rid Of Code For Real - Blog post by Isaac Pehrson">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="../../favicon.svg">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        /* IsaacPCodes Brand System - Blog Post Variant */
        :root {
            --bg: #0B0F1A;
            --text: #E6E8EB;
            --accent: #5EEAD4;
            --text-muted: #9CA3AF;
            --code-bg: rgba(94, 234, 212, 0.05);
            
            --space-xs: 0.5rem;
            --space-sm: 1rem;
            --space-md: 1.5rem;
            --space-lg: 2rem;
            --space-xl: 3rem;
            --space-2xl: 4rem;
            
            --radius-sm: 12px;
            --radius-md: 16px;
            
            --font-main: Inter, "Space Grotesk", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: var(--font-main);
            font-size: 16px;
            line-height: 1.7;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: var(--space-md);
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.95rem;
            margin-bottom: var(--space-lg);
            transition: color 0.2s ease;
            padding: var(--space-sm) 0;
        }
        
        .back-link:hover {
            color: var(--accent);
        }
        
        .back-link::before {
            content: "←";
            margin-right: var(--space-xs);
            color: var(--accent);
        }
        
        .back-link:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
        
        .header {
            border-bottom: 1px solid rgba(94, 234, 212, 0.1);
            padding-bottom: var(--space-lg);
            margin-bottom: var(--space-2xl);
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 500;
            margin-bottom: var(--space-sm);
            line-height: 1.3;
            letter-spacing: -0.02em;
        }
        
        .date {
            color: var(--text-muted);
            font-size: 0.95rem;
        }
        
        .content {
            color: var(--text);
        }
        
        .content h2 {
            font-size: 1.75rem;
            font-weight: 500;
            margin-top: var(--space-xl);
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 1px solid rgba(94, 234, 212, 0.1);
            color: var(--text);
        }
        
        .content h3 {
            font-size: 1.35rem;
            font-weight: 500;
            margin-top: var(--space-lg);
            margin-bottom: var(--space-sm);
            color: var(--text);
        }
        
        .content h4 {
            font-size: 1.15rem;
            font-weight: 500;
            margin-top: var(--space-md);
            margin-bottom: var(--space-sm);
            color: var(--text);
        }
        
        .content p {
            margin-bottom: var(--space-md);
            line-height: 1.8;
        }
        
        .content ul,
        .content ol {
            margin-bottom: var(--space-md);
            padding-left: var(--space-lg);
        }
        
        .content li {
            margin-bottom: var(--space-xs);
            line-height: 1.7;
        }
        
        .content a {
            color: var(--accent);
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: border-color 0.2s ease;
        }
        
        .content a:hover {
            border-bottom-color: var(--accent);
        }
        
        .content a:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
        
        .content code {
            background: var(--code-bg);
            color: var(--accent);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-family: var(--font-mono);
            font-size: 0.9em;
            border: 1px solid rgba(94, 234, 212, 0.15);
        }
        
        .content pre {
            background: var(--code-bg);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
            overflow-x: auto;
            margin-bottom: var(--space-md);
            border: 1px solid rgba(94, 234, 212, 0.15);
        }
        
        .content pre code {
            padding: 0;
            background: transparent;
            border: none;
            color: var(--text);
        }
        
        .content blockquote {
            border-left: 3px solid var(--accent);
            padding-left: var(--space-md);
            margin: var(--space-md) 0;
            color: var(--text-muted);
            font-style: italic;
        }
        
        .content img {
            max-width: 100%;
            height: auto;
            border-radius: var(--radius-sm);
            margin: var(--space-md) 0;
            border: 1px solid rgba(94, 234, 212, 0.1);
        }
        
        .content hr {
            border: none;
            border-top: 1px solid rgba(94, 234, 212, 0.1);
            margin: var(--space-xl) 0;
        }
        
        .content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--space-md);
        }
        
        .content table th,
        .content table td {
            padding: var(--space-sm);
            border: 1px solid rgba(94, 234, 212, 0.1);
            text-align: left;
        }
        
        .content table th {
            background: var(--code-bg);
            font-weight: 500;
        }
        
        footer {
            border-top: 1px solid rgba(94, 234, 212, 0.1);
            margin-top: var(--space-2xl);
            padding-top: var(--space-xl);
            text-align: center;
        }
        
        .footer-content {
            color: var(--text-muted);
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .content h2 {
                font-size: 1.5rem;
            }
            
            .content h3 {
                font-size: 1.25rem;
            }
            
            .container {
                padding: var(--space-sm);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">Back to Blog</a>
        <div class="header">
            <h1>Git Rid Of Code For Real</h1>
            <div class="date">2025-12-13</div>
        </div>
        <article class="content">
<h2>Describe the issue</h2>
<p>I think we've all committed by accident a secret to a git repository, and then found it to be non-trivial to remove that from the entire git history.</p>
<p>In git, if you commit a secret or a key, it's there forever. You can remove it, but it will always live in your git history. So it's just covered up, it's not really gone.</p>
<p>For my example, i needed to remove all links of ebay.com from a particular repo. I wanted to just simply search for that domain, and if it matched on a line, i wanted that entire line deleted.</p>
<p>Not just simply deleted, but removed from all git history. Here's how i did that:</p>
<h2>Solution</h2>
<p>There are many ways to accomplish this, this is not the only way to do this, nor may all think it is the <em>correct</em> way to do this. But it did for me what i wanted.</p>
<h3>Step 1 - Clone a git mirror</h3>
<p>Since it's wise to keep a backup while we are performing this, I did all the work in a mirrored clone.</p>
<pre><code>git clone --mirror &lt;repository-url&gt; repo-mirror.git
cd repo-mirror.git
</code></pre>
<h3>Step 2 - Remove Files/Directories/String matches</h3>
<h4>When i wanted to remove directories completely:</h4>
<pre><code>git filter-repo --path src/components/UnwantedComponent --invert-paths
</code></pre>
<h4>When i wanted to remove by a string match:</h4>
<p>The normal syntax for this string-replace is something like</p>
<p><code>search-string==&gt;replace-string</code></p>
<p>And then the command would be:</p>
<p><code>git filter-repo --replace-text ./replacements.txt</code></p>
<p><code>replacements.txt</code> being a simple text file i created with the string match syntax.</p>
<p>I wanted to do something a little tricky, i wasn't simply finding and replacing strings. Instead I wanted to look for matches of 'ebay.com' and then remove the entire line. In order to do this i used a regex approach:</p>
<p><code>regex:.*secret.example.com.*\n==&gt;</code></p>
<p>What this does
.*secret.example.com.* → matches the entire line containing the secret</p>
<p>\n → includes the newline so the whole line disappears cleanly</p>
<p>==&gt; with nothing on the right → deletes it</p>
<h3>Step 4 - Push Changes to Remote</h3>
<p><code>git push --force</code></p>
<h3>Step 4 - Confirm removals worked</h3>
<p>Search repo and ensure string was removed:</p>
<p><code>git rev-list --all | xargs -n 1 git grep -n &quot;ebay.com&quot; || echo &quot;Not found&quot;</code></p>
<p>I did find that i had to repeat the &quot;clone/delete/push&quot; steps a couple times to entirely remove everything. But after a few clones, i can now confirm all matches of said string have been removed.</p>
<h2>Conclusion</h2>
<p>Yeah so there are likely hundreds of ways to do this, and those that have done this several times may be able to point out more proper ways of performing this. But I found these steps to work for me and it performed a difficult Git task that comes up sometimes.</p>
        </article>
        <footer>
            <div class="footer-content">
                <p>&copy; 2025 IsaacPCodes. Built with care.</p>
            </div>
        </footer>
    </div>
</body>
</html>
